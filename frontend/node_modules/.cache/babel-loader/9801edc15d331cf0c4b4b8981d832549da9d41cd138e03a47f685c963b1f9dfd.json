{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\User\\\\Downloads\\\\shh_website_codebase\\\\frontend\\\\src\\\\components\\\\PaymentPage.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport { loadStripe } from '@stripe/stripe-js';\nimport { Elements, CardElement, useStripe, useElements } from '@stripe/react-stripe-js';\nimport Header from './Header';\nimport Footer from './Footer';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst stripePromise = loadStripe(process.env.REACT_APP_STRIPE_PUBLISHABLE_KEY);\nfunction CheckoutForm(_ref) {\n  _s();\n  let {\n    clientSecret,\n    reference\n  } = _ref;\n  const stripe = useStripe();\n  const elements = useElements();\n  const [status, setStatus] = useState('entering'); // 'entering' | 'success' | 'error'\n  const [message, setMessage] = useState('');\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (!stripe || !elements) return;\n    const {\n      error,\n      paymentIntent\n    } = await stripe.confirmCardPayment(clientSecret, {\n      payment_method: {\n        card: elements.getElement(CardElement),\n        billing_details: {\n          name: reference\n        }\n      }\n    });\n    if (error) {\n      setStatus('error');\n      setMessage(error.message);\n    } else if (paymentIntent.status === 'succeeded') {\n      setStatus('success');\n      setMessage(\"Thank you! Your payment succeeded. Ref: \".concat(reference, \". \\n         You can now check your email for details or call us at XXXXX.\"));\n    }\n  };\n  if (status === 'success' || status === 'error') {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: '2rem',\n        color: status === 'error' ? 'red' : 'green'\n      },\n      children: message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: handleSubmit,\n    style: {\n      maxWidth: 400\n    },\n    children: [/*#__PURE__*/_jsxDEV(CardElement, {\n      options: {\n        hidePostalCode: true\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"submit\",\n      disabled: !stripe,\n      style: {\n        marginTop: '1rem',\n        padding: '0.75rem',\n        background: '#28a745',\n        color: '#fff',\n        border: 'none',\n        borderRadius: 4,\n        cursor: 'pointer'\n      },\n      children: [\"Pay \\xA3\", (1000 / 100).toFixed(2)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 5\n  }, this);\n}\n_s(CheckoutForm, \"9xNoozGYibsOod/hNixpn0spvos=\", false, function () {\n  return [useStripe, useElements];\n});\n_c = CheckoutForm;\nexport default function PaymentPage() {\n  _s2();\n  const [searchParams] = useSearchParams();\n  const reference = searchParams.get('reference');\n  const [clientSecret, setClientSecret] = useState('');\n  useEffect(() => {\n    // create a PaymentIntent as soon as we mount\n    fetch('/api/create-payment-intent', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        reference,\n        amount: 1000\n      })\n    }).then(r => r.json()).then(data => {\n      if (data.error) throw new Error(data.error);\n      setClientSecret(data.clientSecret);\n    }).catch(e => setClientSecret('ERROR:' + e.message));\n  }, [reference]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Header, {\n      title: \"Complete Your Payment\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      style: {\n        padding: '2rem',\n        textAlign: 'center'\n      },\n      children: [!reference && /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          color: 'red'\n        },\n        children: \"Missing reference!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 24\n      }, this), clientSecret.startsWith('ERROR:') && /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          color: 'red'\n        },\n        children: clientSecret.slice(6)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 11\n      }, this), clientSecret && !clientSecret.startsWith('ERROR:') ? /*#__PURE__*/_jsxDEV(Elements, {\n        stripe: stripePromise,\n        children: /*#__PURE__*/_jsxDEV(CheckoutForm, {\n          clientSecret: clientSecret,\n          reference: reference\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Loading payment form\\u2026\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n_s2(PaymentPage, \"NUteCdbswpObQvXoa6lh6Hz+Vms=\", false, function () {\n  return [useSearchParams];\n});\n_c2 = PaymentPage;\nvar _c, _c2;\n$RefreshReg$(_c, \"CheckoutForm\");\n$RefreshReg$(_c2, \"PaymentPage\");","map":{"version":3,"names":["React","useState","useEffect","useSearchParams","loadStripe","Elements","CardElement","useStripe","useElements","Header","Footer","jsxDEV","_jsxDEV","Fragment","_Fragment","stripePromise","process","env","REACT_APP_STRIPE_PUBLISHABLE_KEY","CheckoutForm","_ref","_s","clientSecret","reference","stripe","elements","status","setStatus","message","setMessage","handleSubmit","e","preventDefault","error","paymentIntent","confirmCardPayment","payment_method","card","getElement","billing_details","name","concat","style","marginTop","color","children","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","maxWidth","options","hidePostalCode","type","disabled","padding","background","border","borderRadius","cursor","toFixed","_c","PaymentPage","_s2","searchParams","get","setClientSecret","fetch","method","headers","body","JSON","stringify","amount","then","r","json","data","Error","catch","title","textAlign","startsWith","slice","_c2","$RefreshReg$"],"sources":["C:/Users/User/Downloads/shh_website_codebase/frontend/src/components/PaymentPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useSearchParams } from 'react-router-dom';\r\nimport { loadStripe } from '@stripe/stripe-js';\r\nimport {\r\n  Elements,\r\n  CardElement,\r\n  useStripe,\r\n  useElements\r\n} from '@stripe/react-stripe-js';\r\nimport Header from './Header';\r\nimport Footer from './Footer';\r\n\r\nconst stripePromise = loadStripe(\r\n  process.env.REACT_APP_STRIPE_PUBLISHABLE_KEY\r\n);\r\n\r\nfunction CheckoutForm({ clientSecret, reference }) {\r\n  const stripe = useStripe();\r\n  const elements = useElements();\r\n  const [status, setStatus] = useState('entering'); // 'entering' | 'success' | 'error'\r\n  const [message, setMessage] = useState('');\r\n\r\n  const handleSubmit = async e => {\r\n    e.preventDefault();\r\n    if (!stripe || !elements) return;\r\n\r\n    const { error, paymentIntent } = await stripe.confirmCardPayment(\r\n      clientSecret,\r\n      {\r\n        payment_method: {\r\n          card: elements.getElement(CardElement),\r\n          billing_details: { name: reference }\r\n        }\r\n      }\r\n    );\r\n\r\n    if (error) {\r\n      setStatus('error');\r\n      setMessage(error.message);\r\n    } else if (paymentIntent.status === 'succeeded') {\r\n      setStatus('success');\r\n      setMessage(\r\n        `Thank you! Your payment succeeded. Ref: ${reference}. \r\n         You can now check your email for details or call us at XXXXX.`\r\n      );\r\n    }\r\n  };\r\n\r\n  if (status === 'success' || status === 'error') {\r\n    return <div style={{ marginTop: '2rem', color: status === 'error' ? 'red' : 'green' }}>\r\n      {message}\r\n    </div>;\r\n  }\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit} style={{ maxWidth: 400 }}>\r\n      <CardElement options={{ hidePostalCode: true }} />\r\n      <button\r\n        type=\"submit\"\r\n        disabled={!stripe}\r\n        style={{\r\n          marginTop: '1rem',\r\n          padding: '0.75rem',\r\n          background: '#28a745',\r\n          color: '#fff',\r\n          border: 'none',\r\n          borderRadius: 4,\r\n          cursor: 'pointer'\r\n        }}\r\n      >\r\n        Pay Â£{(1000/100).toFixed(2)}\r\n      </button>\r\n    </form>\r\n  );\r\n}\r\n\r\nexport default function PaymentPage() {\r\n  const [searchParams] = useSearchParams();\r\n  const reference = searchParams.get('reference');\r\n  const [clientSecret, setClientSecret] = useState('');\r\n\r\n  useEffect(() => {\r\n    // create a PaymentIntent as soon as we mount\r\n    fetch('/api/create-payment-intent', {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({ reference, amount: 1000 })\r\n    })\r\n      .then(r => r.json())\r\n      .then(data => {\r\n        if (data.error) throw new Error(data.error);\r\n        setClientSecret(data.clientSecret);\r\n      })\r\n      .catch(e => setClientSecret('ERROR:' + e.message));\r\n  }, [reference]);\r\n\r\n  return (\r\n    <>\r\n      <Header title=\"Complete Your Payment\" />\r\n      <main style={{ padding: '2rem', textAlign: 'center' }}>\r\n        {!reference && <p style={{ color: 'red' }}>Missing reference!</p>}\r\n        {clientSecret.startsWith('ERROR:') && (\r\n          <p style={{ color: 'red' }}>{clientSecret.slice(6)}</p>\r\n        )}\r\n        {clientSecret && !clientSecret.startsWith('ERROR:') ? (\r\n          <Elements stripe={stripePromise}>\r\n            <CheckoutForm\r\n              clientSecret={clientSecret}\r\n              reference={reference}\r\n            />\r\n          </Elements>\r\n        ) : (\r\n          <p>Loading payment formâ¦</p>\r\n        )}\r\n      </main>\r\n      <Footer />\r\n    </>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}