{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\User\\\\Downloads\\\\shh_website_codebase\\\\frontend\\\\src\\\\components\\\\PaymentPage.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useSearchParams, useNavigate } from 'react-router-dom';\nimport { loadStripe } from '@stripe/stripe-js';\nimport { Elements, CardElement, useStripe, useElements } from '@stripe/react-stripe-js';\nimport Header from './Header';\nimport Footer from './Footer';\nimport styles from '../css/PaymentPage.module.css';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst stripePromise = loadStripe(process.env.REACT_APP_STRIPE_PUBLISHABLE_KEY);\nfunction CheckoutForm(_ref) {\n  _s();\n  let {\n    clientSecret,\n    reference\n  } = _ref;\n  const stripe = useStripe();\n  const elements = useElements();\n  const [errorMessage, setErrorMessage] = useState('');\n  const [processing, setProcessing] = useState(false);\n\n  // handle real-time validation errors\n  const handleChange = event => {\n    setErrorMessage(event.error ? event.error.message : '');\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (!stripe || !elements) return;\n    setProcessing(true);\n    setErrorMessage('');\n    const card = elements.getElement(CardElement);\n    const {\n      error,\n      paymentIntent\n    } = await stripe.confirmCardPayment(clientSecret, {\n      payment_method: {\n        card,\n        billing_details: {\n          name: reference\n        }\n      }\n    });\n    if (error) {\n      setErrorMessage(error.message);\n      setProcessing(false);\n    } else if (paymentIntent.status === 'succeeded') {\n      // You could also redirect or reload here\n      window.location.reload();\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: handleSubmit,\n    className: styles.form,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.cardContainer,\n      children: /*#__PURE__*/_jsxDEV(CardElement, {\n        options: {\n          style: {\n            base: {\n              fontSize: '16px',\n              color: '#424770'\n            },\n            invalid: {\n              color: '#9e2146'\n            }\n          }\n        },\n        onChange: handleChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }, this), errorMessage && /*#__PURE__*/_jsxDEV(\"p\", {\n      className: styles.cardError,\n      children: errorMessage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"submit\",\n      disabled: !stripe || processing,\n      className: styles.payButton,\n      children: processing ? 'Processing…' : 'Pay £10.00'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 53,\n    columnNumber: 5\n  }, this);\n}\n_s(CheckoutForm, \"+RZYXCiO4USsbI+asMYFuYe76W0=\", false, function () {\n  return [useStripe, useElements];\n});\n_c = CheckoutForm;\nexport default function PaymentPage() {\n  _s2();\n  const [searchParams] = useSearchParams();\n  const navigate = useNavigate();\n  const reference = searchParams.get('reference');\n  const [clientSecret, setClientSecret] = useState('');\n  useEffect(() => {\n    if (!reference) return;\n    fetch('/api/create-payment-intent', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        reference,\n        amount: 1000\n      })\n    }).then(r => r.json()).then(data => {\n      if (data.error) throw new Error(data.error);\n      setClientSecret(data.clientSecret);\n    }).catch(e => setClientSecret('ERROR:' + e.message));\n  }, [reference]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Header, {\n      title: \"Complete Your Payment\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: styles.wrapper,\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        onClick: () => navigate(-1),\n        className: styles.backButton,\n        children: \"\\u2190 Back to Booking\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 9\n      }, this), !reference && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: styles.errorText,\n        children: \"Missing reservation reference.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 11\n      }, this), clientSecret.startsWith('ERROR:') && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: styles.errorText,\n        children: clientSecret.slice(6)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 11\n      }, this), clientSecret && !clientSecret.startsWith('ERROR:') ? /*#__PURE__*/_jsxDEV(Elements, {\n        stripe: stripePromise,\n        children: /*#__PURE__*/_jsxDEV(CheckoutForm, {\n          clientSecret: clientSecret,\n          reference: reference\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Loading payment form\\u2026\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n_s2(PaymentPage, \"u5URiZhBLnZbQ1i9JI/rY1wyD9U=\", false, function () {\n  return [useSearchParams, useNavigate];\n});\n_c2 = PaymentPage;\nvar _c, _c2;\n$RefreshReg$(_c, \"CheckoutForm\");\n$RefreshReg$(_c2, \"PaymentPage\");","map":{"version":3,"names":["React","useState","useEffect","useSearchParams","useNavigate","loadStripe","Elements","CardElement","useStripe","useElements","Header","Footer","styles","jsxDEV","_jsxDEV","Fragment","_Fragment","stripePromise","process","env","REACT_APP_STRIPE_PUBLISHABLE_KEY","CheckoutForm","_ref","_s","clientSecret","reference","stripe","elements","errorMessage","setErrorMessage","processing","setProcessing","handleChange","event","error","message","handleSubmit","e","preventDefault","card","getElement","paymentIntent","confirmCardPayment","payment_method","billing_details","name","status","window","location","reload","onSubmit","className","form","children","cardContainer","options","style","base","fontSize","color","invalid","onChange","fileName","_jsxFileName","lineNumber","columnNumber","cardError","type","disabled","payButton","_c","PaymentPage","_s2","searchParams","navigate","get","setClientSecret","fetch","method","headers","body","JSON","stringify","amount","then","r","json","data","Error","catch","title","wrapper","onClick","backButton","errorText","startsWith","slice","_c2","$RefreshReg$"],"sources":["C:/Users/User/Downloads/shh_website_codebase/frontend/src/components/PaymentPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useSearchParams, useNavigate } from 'react-router-dom';\r\nimport { loadStripe } from '@stripe/stripe-js';\r\nimport {\r\n  Elements,\r\n  CardElement,\r\n  useStripe,\r\n  useElements\r\n} from '@stripe/react-stripe-js';\r\nimport Header from './Header';\r\nimport Footer from './Footer';\r\nimport styles from '../css/PaymentPage.module.css';\r\n\r\nconst stripePromise = loadStripe(\r\n  process.env.REACT_APP_STRIPE_PUBLISHABLE_KEY\r\n);\r\n\r\nfunction CheckoutForm({ clientSecret, reference }) {\r\n  const stripe = useStripe();\r\n  const elements = useElements();\r\n  const [errorMessage, setErrorMessage] = useState('');\r\n  const [processing, setProcessing] = useState(false);\r\n\r\n  // handle real-time validation errors\r\n  const handleChange = (event) => {\r\n    setErrorMessage(event.error ? event.error.message : '');\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    if (!stripe || !elements) return;\r\n    setProcessing(true);\r\n    setErrorMessage('');\r\n\r\n    const card = elements.getElement(CardElement);\r\n    const { error, paymentIntent } = await stripe.confirmCardPayment(\r\n      clientSecret,\r\n      {\r\n        payment_method: { card, billing_details: { name: reference } }\r\n      }\r\n    );\r\n\r\n    if (error) {\r\n      setErrorMessage(error.message);\r\n      setProcessing(false);\r\n    } else if (paymentIntent.status === 'succeeded') {\r\n      // You could also redirect or reload here\r\n      window.location.reload();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit} className={styles.form}>\r\n      <div className={styles.cardContainer}>\r\n        <CardElement\r\n          options={{\r\n            style: {\r\n              base: { fontSize: '16px', color: '#424770' },\r\n              invalid: { color: '#9e2146' }\r\n            }\r\n          }}\r\n          onChange={handleChange}\r\n        />\r\n      </div>\r\n      {errorMessage && (\r\n        <p className={styles.cardError}>{errorMessage}</p>\r\n      )}\r\n      <button\r\n        type=\"submit\"\r\n        disabled={!stripe || processing}\r\n        className={styles.payButton}\r\n      >\r\n        {processing ? 'Processing…' : 'Pay £10.00'}\r\n      </button>\r\n    </form>\r\n  );\r\n}\r\n\r\nexport default function PaymentPage() {\r\n  const [searchParams] = useSearchParams();\r\n  const navigate = useNavigate();\r\n  const reference = searchParams.get('reference');\r\n  const [clientSecret, setClientSecret] = useState('');\r\n\r\n  useEffect(() => {\r\n    if (!reference) return;\r\n    fetch('/api/create-payment-intent', {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({ reference, amount: 1000 })\r\n    })\r\n      .then(r => r.json())\r\n      .then(data => {\r\n        if (data.error) throw new Error(data.error);\r\n        setClientSecret(data.clientSecret);\r\n      })\r\n      .catch(e => setClientSecret('ERROR:' + e.message));\r\n  }, [reference]);\r\n\r\n  return (\r\n    <>\r\n      <Header title=\"Complete Your Payment\" />\r\n\r\n      <main className={styles.wrapper}>\r\n        <button\r\n          type=\"button\"\r\n          onClick={() => navigate(-1)}\r\n          className={styles.backButton}\r\n        >\r\n          ← Back to Booking\r\n        </button>\r\n\r\n        {!reference && (\r\n          <p className={styles.errorText}>\r\n            Missing reservation reference.\r\n          </p>\r\n        )}\r\n\r\n        {clientSecret.startsWith('ERROR:') && (\r\n          <p className={styles.errorText}>\r\n            {clientSecret.slice(6)}\r\n          </p>\r\n        )}\r\n\r\n        {clientSecret && !clientSecret.startsWith('ERROR:') ? (\r\n          <Elements stripe={stripePromise}>\r\n            <CheckoutForm\r\n              clientSecret={clientSecret}\r\n              reference={reference}\r\n            />\r\n          </Elements>\r\n        ) : (\r\n          <p>Loading payment form…</p>\r\n        )}\r\n      </main>\r\n\r\n      <Footer />\r\n    </>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}